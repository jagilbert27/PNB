{% extends "base.html" %} {% block title %}Student{% endblock %} {% block
content %}



<div class="d-flex justify-content-between bg-primary text-white rounded p-2">
  <h3>
    <span style="font-weight:100">
      {% if readonly==True %}
      View
      {% elif student.id %}
      Edit
      {% else %}
      New
      {% endif %}</span>
    <span style="font-weight: 700">Student</span>
  </h3>
  {% if student.id is not none and readonly != true%}
  <div>
    <div class="rounded wrap" >
    <a href="{{ url_for('views.checkout_new',student_id=student.id)}}" type="button" class="btn btn-outline-success" >
      <span aria-hidden="true"><i class="bi bi-check2-circle"></i>&nbsp;Checkout an Instrument</span>
    </a>
  </div>
  <div class="rounded wrap" >
    <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#confirm-delete">
      <span><i class="bi bi-trash"></i>&nbsp;Delete this Student</span>
    </button>
    </div>


  </div>
  {% endif %}
</div>

  <br />
<form class="row g-3" style='background-color: #eee;' method="POST">
  {% if readonly==true %}
 
  <fieldset disabled="disabled" class="row g-3" >
  {% endif %}

  <!-- First Name -->
  <div class="col-md-6 required">
    <div class="form-floating mb-3">
      <input type="text" required class="form-control" id="first_name" name="first_name"
        value="{% if student.first_name %}{{student.first_name}}{% endif %}" />
      <label for="first_name">First Name*</label>
    </div>
  </div>

  <!-- Last Name -->
  <div class="col-md-6 required">
    <div class="form-floating mb-3">
      <input type="text" required class="form-control" id="last_name" name="last_name"
        value="{% if student.last_name %}{{student.last_name}}{% endif %}" />
      <label for="last_name">Last Name*</label>
    </div>
  </div>

  <!-- Email -->
  <div class="col-md-12 required">
    <div class="form-floating mb-3">
      <input type="email" required class="form-control" id="email" name="email"
        value="{% if student.email %}{{student.email}}{% endif %}" />
      <label for="email">Email*</label>
    </div>
  </div>

{% if student.id %}
<!-- Checkouts -->
<div class="col-md-12 form-group required">
  <h5 style="color:steelblue;"> Checkout History</h5>
  <table id=student-table class='table table-striped'>
    <thead id="table-head" class='text-white' style="background:steelblue;">
      <tr style='vertical-align: middle; '>
        <th>Checked Out</th>
        <th>Tag</th>
        <th class="d-none d-sm-table-cell">Type</th>
        <th class="d-none d-md-table-cell"> Out Condition</th>
        <th>Due</th>
        <th>Returned</th>
        <th class="d-none d-md-table-cell">In Condition</th>
        <th class="d-none d-md-table-cell">Returned To</th>
        <th></th>

      </tr>
    </thead>
    <tbody id="table-body">
      {% for checkout in student.checkouts %}
      <tr>
        <td style="white-space:nowrap">{{ checkout.checkout_date }}</td>
        <td><b><a style="text-decoration-line:none"
              href="{{ url_for('views.instrument_edit', id=checkout.instrument.id)}}">{{ checkout.instrument.tag
              }}</a></b></td>
        <td class="d-none d-sm-table-cell">{{ checkout.instrument.type.name }}</a></td>
        <td class="d-none d-md-table-cell">{{ checkout.checkout_condition.name }}</td>
        <td>{{ checkout.due_date }}</td>
        <td>{{ checkout.return_date }}</td>
        <td class="d-none d-md-table-cell">{{ checkout.return_condition.name }}</td>
        <td class="d-none d-md-table-cell">{{ checkout.return_location }}</td>
        <td style="text-align: end;">
          {% if not checkout.return_date %}
          <a href="{{ url_for('views.checkout_edit',id=checkout.id)}}" type="button"
            class="btn btn-outline-success btn-sm bg-white">
            <span aria-hidden="true"><i class="bi bi-check2-circle"></i>&nbsp;Return Instrument</span>
          </a>
          {% else %}
          <div class="wrap">
            <a href="{{ url_for('views.checkout_edit',id=checkout.id)}}" type="button"
              class="btn btn-outline-success btn-sm">
              <span aria-hidden="true"><i class="bi bi-check2-circle"></i></span>
            </a>
          </div>
        </td>
        {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endif %}

  {% if readonly==true %}
  <fieldset disabled="disabled">
  {% else %}
  <br />
  <div class="col-md-2 form-group ">
    <button type="submit" class="btn btn-primary">Submit</button>
  </div>
  {% endif %}
 </form>

<!-- Confirm Delete Modal -->
<div class="modal fade" id="confirm-delete" aria-hidden="true" aria-labelledby="modal-title">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title modal-title" id=modal-title>Delete {{student.first_name}}</h5>
        <button type=button class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-title"></div>
      <div class="modal-body">
        Are you sure you want to delete {{student.first_name}}?
      </div>
      <div class="modal-footer">
        <button onClick="deleteStudent({{ student.id }})" class="btn btn-danger">Delete</button>
        <button class="btn btn-primary" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
      </div>
    </div>
  </div>
</div>

<!-- ToDo List -->
<br/>
<div class="accordion" id="accordionExample">
  <div class="accordion-item">
    <h2 class="accordion-header" id="headingOne">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
        To Do List
      </button>
    </h2>
    <div id="collapseOne" class="accordion-collapse collapse " aria-labelledby="headingOne" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <ul>
          <li>Edit Mode</li>
            <ul>
              <li><del>Add a delete button</del></li>
              <li><del>confirm delete dlg</del></li>
            </ul>
            <li>New Mode</li>
            <ul>
              <li><del>Make it work</del></li>
              <li><del>Flash a nice message</del></li>
            </ul>
            <li>List</li>
            <ul>
              <li><del>fix condition field</del></li>
            </ul>
          <li><del>Convert to floating labels</del></li>
          <li>add Notes field</li>
          <li><del>email validator</del></li>
          <li>flash warning if email also used by ___ </li>
          <li>Add fields as necessary</li>
          <li>Auth protect page</li>
          <li>Auth protect delete</li>
          <li>List: placeholder if none</li>
          <li>Import from Google Sheets</li>
          <ul>
            <li>Enable Google API</li>
          </ul>
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}